### 建模样本的前期准备工作

## **Part 1. 观察期、观察点及表现期**

- **观察点**:观察期并不是一个具体的时间点，也可以是一段时间，这段时间内的样本可能被用来作为建模样本(为什么是可能？因为这期间的一些样本可能会命中一些强规则,这些样本需要被剔除)

- **观察期**（Observation Window）：用以**构造特征X**的时间窗口。相对于观察点而言，是**历史**时间。观察期的选择依赖于用户数据的厚薄程度。通常数据越厚，可提取的信息也就越全面、可靠。
- **表现期**（Performance Window）：定义**好坏标签Y**的时间窗口。相对于观察点而言，是**未来**时间。由于风险需要有一定时间窗才能表现出来，因此信贷风险具有**滞后性**。表现期的长短可以通过Vintage分析和滚动率分析来确定，在此不做展开

![](https://pic3.zhimg.com/80/v2-c47416a557f573a72acccb00ec5a37fe_1440w.jpg)

## **Part 2. RFM模型介绍**

RFM模型最早是用来衡量客户价值和客户创力能力，其含义为：

- R(Recency):客户最近一次消费时间的间隔。R值越大，表示客户交易发生的日期间隔越久，反之则表示客户交易发生的日期越近
- F(Frequency) ：客户在最近一段时间内交易消费的次数。F值越大，表示客户交易的越频繁，反之则表示最近不活跃。
- M(Monetary): 客户在最近一段时间内消费交易的金额。M值越大，表示客户价值越高，反之则表示客户价值越低。

## **Part 3. 时间滑窗数量统计类特征**

对于不同的数据源，我们可以统计得到不同内容的RFM特征。

- 运营商数据：用户每天的通话次数，通话时长(最大，最小，平均)

- 信用卡账单或电商交易数据：用户交易频次，交易的金额等

- 埋点行为数据：用户每天在某个页面的浏览量、点击量，点击时长，前后点击间隔

- 设备数据： 用户登陆次数，活跃次数(需要定义活跃的概念)

- 信用卡交易数据：用户每天在母婴用品、交通出行、餐饮、美容美发等交易笔数、金额。

- 设备App数据：用户手机上安装的借贷类、生活类、运动类、音乐类等App的数量。

  ![img](https://pic2.zhimg.com/80/v2-e8569329967d9a0e5cccaa9302389c75_1440w.jpg) 图 2 - 截止下单日，用户每天统计的App数量

需要指出的是，我们**需要结合业务去分析数据，数据因为业务才具有温度**。

🌟**敲黑板划重点1——了解数据采集逻辑**

对于采集客观、可靠的数据源而言，分析过程就相对简单。比如，如果用户某天没有打电话，那么当天的通话次数就为0，这是因为运营商客观的保留了用户的原始数据，这时候0的含义就是用户当天没有通话行为。

对于依赖于用户登录、活跃才能采集到的数据，就需要结合采集方式来分析。比如在设备App数据中，如果某天统计得到用户安装的借贷类app为0.这个数字后面可能有哪些原因呢？

	- **统计函数导致**：用户这一天并没有使用手机，导致数据采集上的缺失，但是sql中count(null)=0，也就是会将缺失值填充默认为0
	- **用户行为统计**;用户使用了新的安卓手机，数据采集正常，但确实没有安装借贷类App，因此统计值为0.或者，用户使用了老安卓手机，但主动卸载了所有借贷类APP。
	- **数据采集技术**：用户使用的是苹果手机，由于无法采集到APP数据，哪怕手机上安装了借贷类App，但统计值也为0.
	- **变量构造逻辑**：虽然手机上安装了借贷类app,但是不在你的借贷app名单库中。

那么到底是哪种原因呢？对于这些猜想，我们可以从以下维度加以佐证：

- 用户当天是否活跃？
- 用户使用设备是否出现新的UMID（设备ID）？
- 用户使用设备的平台（iOS / Android）？
- 名单库是否很久没有维护？

这也就是需要**结合业务经验对多个特征交叉衍生新特征**的原因，这种特征具有强业务含义，因此往往能发挥出更好的效果



🌟**敲黑板划重点2——定义观察期有效性**

我们还需**考虑观察期的有效性，以及不同用户的数据厚薄程度**。

比如，如果一个用户手机号网龄才6个月，那么在统计最近6个月、12个月、24个月的通话记录次数时，可想而知这几个变量的数值都是一样的。

同理，对于手机号网龄分别是6个月的新用户和6年的老用户而言，“最近12个月的通话记录次数”这种特征是**不公平（unfair）**的。两者的**数据厚薄程度**不同，新用户的观察期实际上只有6个月，而老用户的观察期是12个月。

为了区分这种情况，有以下建议：

> 1. **定义观察期有效性，**在时间滑窗统计时，更需要有意识地留出有效的观察期。
> 2. **定义分群变量**。比如将数据有效期只有6个月和12个月的用户分成2个群体。

## Part4. 时间滑窗占比统计类特征

在得到数量统计类特征后，我们继续衍生占比(ratio)类特征，一方面可用来出去量纲影响，另外一方面衡量用户的**行为偏好**。

> 最近N个月内xxx次数占比 = 最近N个月XX消费次数/最近N个月内消费总次数

## Part5. 时间滑窗趋势统计类特征

由于一个人的行为是会动态变化的，衡量这种趋势的变化就会有意义。

例如，对于借款人的多头借贷风险，如果多头指标呈现逐步上升的趋势，我们就觉得多头负债风险在上升。借款人往往会采取“拆东墙补西墙”的措施，如果哪一天连东墙都找不到拆，这个击鼓传花的游戏也就game over。

一般通过计算**斜率** 的方式来衡量这种趋势,也可以称为环比增长

> 多投借贷趋势 = (当月的多投借贷次数-上个月的多头借贷次数)/(上个月的多头借贷次数)

## Part6. 时间滑窗稳定性衍生特征

根据不同的时间窗口统计出来数量特征后，我们可以继续衡量用户行为的稳定性。

在数学上，我们可以通过**变异系数(CV) = （标准差/平均值）**来衡量这种数据波动水平。数值越小，代表波动越小，稳定性越好。

比如，计算当前月借贷次数，前一个月借贷次数，前两个月借贷次数，横向的维度来计算cv系数。

## **Part 7. 第三方多头借贷变量衍生**

据笔者所知，目前市场上所提供的第三方多头借贷数据通常包含以下变量：

> 借款人最近7天、1个月、3个月、6个月、12个月、18个月、24个月的某类平台借贷次数
>
> 某类平台包含：消费金融公司、互联网金融公司、银行信贷、数据风控公司等等。

根据这些原始变量，我们可以按照以上方法论衍生一些新变量。例如：

如果以“**最近7天的多头借贷次数 / 最近1个月的多头借贷次数**”，我们便可以判断借款人的**时间维度**上的借贷行为分布。这个变量数值越大，代表近期借贷集中，短期风险更大。

如果以“**最近1个月的银行信贷借贷次数 / 最近1个月的多头借贷次数**”，我们便可以判断借款人的在**借贷平台维度**的分布。这个变量数值越大，可以认为越趋于正面

## Part8. 总结

总的来说，先统计数量。然后从占比、趋势、稳定性、集中性等维度去衍生。